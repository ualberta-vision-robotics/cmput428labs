<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="Cache-Control" content="no-cache"> <meta http-equiv="Pragma" content="no-cache"> <meta http-equiv="Expires" content="Thu, 01 Jan 1970 00:00:00 GMT"> <title> Lab 2.1 - 2D Projective Geometry and Homography Estimation | CMPUT 428/615 Labs </title> <meta name="author" content="Computer Vision and Robotics Research Group "> <meta name="description" content="Lab resources for CMPUT428/615."> <meta name="keywords" content="cmput428, cmput615, ualberta, computing-science academic-website"> <link rel="stylesheet" href="/cmput428labs/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/cmput428labs/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/cmput428labs/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/cmput428labs/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/cmput428labs/assets/img/favi.ico?824de67f88398f637ce988037dfe4447"> <link rel="stylesheet" href="/cmput428labs/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ualberta-vision-robotics.github.io/cmput428labs/2dgeometry"> <script src="/cmput428labs/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/cmput428labs/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/cmput428labs/"> CMPUT 428/615 Labs </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/cmput428labs/">Home </a> </li> <li class="nav-item "> <a class="nav-link" href="/cmput428labs/policies">Policies </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Labs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/cmput428labs/opticalflow">Lab 1.1</a> <a class="dropdown-item " href="/cmput428labs/tracking">Lab 1.2</a> <a class="dropdown-item " href="/cmput428labs/2dgeometry">Lab 2.1</a> <a class="dropdown-item " href="/cmput428labs/3dgeometry">Lab 2.2</a> <a class="dropdown-item " href="/cmput428labs/structurefrommotion">Lab 3</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Lab 2.1 - 2D Projective Geometry and Homography Estimation</h1> <p class="post-description"></p> </header> <article> <div class="row justify-content-md-center"> <div class="col-sm-12 mt-6 mt-md-6"> <figure> <video src="/cmput428labs/assets/img/im_disk.webm" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Imaginal disk in bladerunner" autoplay="" loop=""></video> </figure> </div> </div> <div class="caption"> Using homography warps to project an image onto tracked points in a scene. Source material from [<a href="https://pitchfork.com/reviews/albums/magdalena-bay-imaginal-disk/" target="_blank" rel="external nofollow noopener">1</a>, <a href="https://youtu.be/2wXymtELxlI?si=l3456nuDU0KPCGiC&amp;t=50" target="_blank" rel="external nofollow noopener">2</a>]. </div> <h2 id="overview">Overview</h2> <p>In this lab you’ll learn about 2D projective geometry and homography estimation.</p> <p><strong>Important: You can obtain 2 bonus marks for each section you finish and demo while present during the lab period we introduce the lab.</strong></p> <hr> <h2 id="1-homogeneous-transforms-20">1. Homogeneous Transforms (20)</h2> <p>A transformatrion matrix, \(M\), can be used to transform 2D points in homogeneous form:</p> <p>\begin{equation} \left(\begin{array}{l} \displaylines{x’\\ y’\\ w} \end{array}\right) = M \left(\begin{array}{l} \displaylines{x\\ y\\ 1} \end{array}\right) \end{equation}</p> <p>We define translation, rotation, scale and shear matricies in homogenenous coordinates as follows:</p> <p>\begin{equation} T=\left[\begin{array}{ccc} \displaylines{ 1 &amp; 0 &amp; t_x\\ 0 &amp; 1 &amp; t_y\\ 0 &amp; 0 &amp; 1 } \end{array}\right] \end{equation}</p> <p>\begin{equation} R=\left[\begin{array}{ccc} \displaylines{ cos\theta &amp; -sin\theta &amp; 0\\ sin\theta &amp; cos\theta &amp; 0\\ 0 &amp; 0 &amp; 1 } \end{array}\right] \end{equation}</p> <p>\begin{equation} S=\left[\begin{array}{ccc} \displaylines{ s_x &amp; 0 &amp; 0\\ 0 &amp; s_y &amp; 0\\ 0 &amp; 0 &amp; 1 } \end{array}\right] \end{equation}</p> <p>\begin{equation} Sh=\left[\begin{array}{ccc} \displaylines{ 1 &amp; sh_x &amp; 0\\ sh_y &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 1 } \end{array}\right] \end{equation}</p> <p>These matrices transform the homogeneous points with respect to the coordinate origin. They can be multiplied in any order and order of multiplication determines the order of the transformations performed on the points. For further reading, see Chapter 2.4 of Hartley and Zisserman.</p> <p>The following code loads the point cloud <a href="/cmput428labs/assets/labs/house.npy" target="_blank">house.npy</a> and displays it in a 2d scatterplot. Use these points to complete Question 1. You must add the homogeneous coordinate row yourself.</p> <p><a href="/cmput428labs/assets/labs/house.txt" target="_blank">house.txt</a> is also available if you prefer. Use <code class="language-plaintext highlighter-rouge">np.loadtxt()</code> with <code class="language-plaintext highlighter-rouge">delimiter=','</code> to load it.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">happy.npy</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">house</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">house</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">house</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">box</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">House</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <h3 id="a-2d-homogeneous-transformations">a) 2D Homogeneous Transformations</h3> <div class="row justify-content-md-center"> <div class="col-sm-10 mt-6 mt-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/house-480.webp 480w,/cmput428labs/assets/img/house-800.webp 800w,/cmput428labs/assets/img/house-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/house.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="house subplots" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Plots of various transformations on the 2D house point cloud. </div> <ul> <li>Create functions that create translation, rotation, scale and shear transformation matricies using the equations provided above. Apply the following transformations to our provided house point cloud and recreate the above figure. <ol> <li>Original Point Cloud.</li> <li>Translate by (100, -50).</li> <li>Rotate by +90 degrees.</li> <li>Rotate by -90 degrees about centroid.</li> <li>Scale by (0.5, -1).</li> <li>Shear by (0.2, 0).</li> <li>Affine transformation given <code class="language-plaintext highlighter-rouge">Affine = np.array([[0.9, -0.2, 10], [0.3, 1.2, 10]])</code>.</li> <li>Homography transformation given <code class="language-plaintext highlighter-rouge">Homography = np.array([[1, 0, 0], [0, 1, 0], [0.005, 0, 1]])</code>. Ensure you divide all points by the homogeneous coordinate after applying the transformation.</li> </ol> </li> <li><strong>You will lose marks if your house is not at the same coordinates as our figure.</strong></li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Save your image to include with your submission.</li> <li>Display the image in your report.</li> </ul> <p><strong>Report Question 1a:</strong> What group of transformations do translation, rotation, scale and shear belong to? Name two ways these transformations differ from projective (homography) transforms?</p> <h3 id="b-create-a-composite-image">b) Create a composite image</h3> <div class="row justify-content-md-center"> <div class="col-sm-12 mt-6 mt-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/street-480.webp 480w,/cmput428labs/assets/img/street-800.webp 800w,/cmput428labs/assets/img/street-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/street.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="homography on houses" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Homography transforms applied to the house to create a simple street image. </div> <ul> <li>Using a homography transform and our provided point cloud, approximately recreate the above image.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Display the image in your report.</li> <li>Save your image to include with your submission.</li> </ul> <p><strong>Report Question 1b:</strong> Describe how you created this image and the transformations you used.</p> <h3 id="c-bonus-5---adding-your-own-assets">c) Bonus (5) - Adding your own assets</h3> <div class="row justify-content-md-center"> <div class="col-sm-6 mt-6 mt-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/pickles-480.webp 480w,/cmput428labs/assets/img/pickles-800.webp 800w,/cmput428labs/assets/img/pickles-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/pickles.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Don't forget the .pkl's!" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Getting a point cloud from an image. </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">cv2</span>

<span class="k">def</span> <span class="nf">get_point_cloud</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
    <span class="p">(</span><span class="n">dimy</span><span class="p">,</span> <span class="n">dimx</span><span class="p">)</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">shape</span>
    <span class="n">dimx</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">dimx</span><span class="o">*</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">dimy</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">dimy</span><span class="o">*</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">dimx</span><span class="p">,</span> <span class="n">dimy</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">threshold</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="n">cv2</span><span class="p">.</span><span class="n">THRESH_BINARY</span><span class="o">+</span><span class="n">cv2</span><span class="p">.</span><span class="n">THRESH_OTSU</span><span class="p">)</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">nonzero</span><span class="p">(</span><span class="n">image</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">T</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="p">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">dimy</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">imread</span><span class="p">(</span><span class="sh">"</span><span class="s">bubble.jpg</span><span class="sh">"</span><span class="p">)</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">image_pts</span> <span class="o">=</span> <span class="nf">get_point_cloud</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">box</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Original</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">image_pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_pts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">box</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">scale</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">scale</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Point Cloud</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <ul> <li>Use the above function to generate point clouds of your own assets. Search up coloring page versions of your favorite characters and load them in.</li> <li>Create a composite image of your own using the transformations you’ve learned. Load in at least two assets and transform them to create a scene.</li> <li>Note: Large images can create tens of thousands of points. If it hampers performance reduce the number of points using <code class="language-plaintext highlighter-rouge">scale</code>.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Display the image in your report.</li> <li>Save your image to include with your submission.</li> </ul> <p><strong>Report Question 1c:</strong> Describe how you created this image and the transformations you used.</p> <hr> <h2 id="2-2d-projective-geometry-points-lines-and-their-incidence-20">2. 2D Projective Geometry: Points, lines and their incidence (20)</h2> <h3 id="a-hand-drawing">a) Hand Drawing</h3> <p>The homogeneous equation of a line is given as follows: \begin{equation} l^Tx=ax+by+c=0 \end{equation} It holds true for all points that lie on the line.</p> <p>The following three homogeneous lines display a simplified diagram of a railway track and the horizon.</p> \[l_1=\left(\begin{array}{c} -100 \\ 1 \\ 1 \end{array}\right) \quad l_2=\left(\begin{array}{c} 100 \\ 1 \\ 100 \end{array}\right) \quad l_H=\left(\begin{array}{c} 0 \\ 1 \\ -100 \end{array}\right)\] <p>Sketch the drawing labelling all three lines and the position of the vanishing point, the intersection of \(l_1\) and \(l_2\), given by \(l_1\times l_2\).</p> <p><strong>Deliverables:</strong></p> <ul> <li>Display the sketch in your report (you may use software to draw this sketch or scan a hand sketch).</li> <li>Save the sketch to include with your submission.</li> </ul> <h3 id="b-construct-the-midpoint-and-midline-of-the-football-field-in-the-image-below">b) Construct the midpoint and midline of the football field in the image below.</h3> <div class="row justify-content-md-center"> <div class="col-sm-8 mt-6 mt-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/football_field-480.webp 480w,/cmput428labs/assets/img/football_field-800.webp 800w,/cmput428labs/assets/img/football_field-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/football_field.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="go alphonso davies!" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Save this image to use for question 2b, obtained from [<a href="https://telegrafi.com/en/the-five-pillars-of-bayern-munich-that-real-madrid-must-face/" target="_blank" rel="external nofollow noopener">3</a>]. </div> <ol> <li>Click on the corners of the field using <code class="language-plaintext highlighter-rouge">matplotlib.pyplot.ginput()</code> or your own mouse callback.</li> <li>Convert the points to homogeneous coordinates.</li> <li>Compute the diagonal lines \(l_1\) and \(l_2\) (the line between two points is \(l=p_1\times p_2\)).</li> <li>Compute the midpoint, \(p_m\) using the diagonal lines (the intersection between two lines is \(p=l_1\times l_2\)).</li> <li>Compute the vanishing point, \(p_\infty\) as the intersection of the two short sides of the field.</li> <li>Compute the midline using the vanishing point and the mid-point.</li> </ol> <p><strong>Deliverables:</strong></p> <ul> <li>Display the image with overlaid features in your report.</li> <li>Save the image with overlaid features to include with your submission.</li> </ul> <h3 id="c-bonus-10---construct-the-midpoint-and-midline-on-a-video-sequence">c) Bonus (10) - Construct the midpoint and midline on a video sequence</h3> <ul> <li>Place a book with a textured cover on a table and record a video.</li> <li>Track the four corners of the book using 4 trackers, initialized by mouse clicks. You can use your own tracker or one of openCV’s built in trackers (CSRT is suitable, <a href="https://broutonlab.com/blog/opencv-object-tracking/" rel="external nofollow noopener" target="_blank">see resource on other openCV trackers</a>).</li> <li>Use the tracked positions to draw the midline and midpoint on the book.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Save the video with overlaid features to include with your submission.</li> </ul> <hr> <h2 id="3-robot-visual-servoing-task-specifications-20">3. Robot Visual Servoing Task Specifications (20)</h2> <h3 id="a-line-to-line-constraint">a) Line-to-line constraint</h3> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/parl_1-480.webp 480w,/cmput428labs/assets/img/parl_1-800.webp 800w,/cmput428labs/assets/img/parl_1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/parl_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Line to Line 1" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/parl_2-480.webp 480w,/cmput428labs/assets/img/parl_2-800.webp 800w,/cmput428labs/assets/img/parl_2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/parl_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Line to Line 2" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Line to line constraint for robot visual servoing. </div> <p>\begin{equation} e_{l2l} = y_1 \cdot (y_3 \times y_4) + y_2 \cdot (y_3 \times y_4) \end{equation}</p> <ul> <li>Create a <strong>live implementation</strong> of the line-to-line constraint.</li> <li>Place two box objects in the scene. Initialize the appropriate tracked points with mouse clicks to construct the line to line constraint.</li> <li>You may use openCV’s built in trackers (CSRT is suitable, <a href="https://broutonlab.com/blog/opencv-object-tracking/" rel="external nofollow noopener" target="_blank">see resource on other openCV trackers</a>).</li> <li>Overlay the value of the constraint and the points/lines we are tracking onto the video (see <code class="language-plaintext highlighter-rouge">cv2.putText()</code>).</li> <li>Save a video with overlaid features. Rotate and move one of the books and bring the lines together.</li> <li>Optional: normalize the points and lines before computing the constraints to avoid overly large numbers.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Save the video with overlaid features to include with your submission.</li> <li>Display one frame of your video in your report.</li> </ul> <p><strong>Report Question 3a:</strong> What happens to the value of our constraint when we bring one line to the other?</p> <h3 id="b-parallel-lines-constraint">b) Parallel lines constraint</h3> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/l2l_1-480.webp 480w,/cmput428labs/assets/img/l2l_1-800.webp 800w,/cmput428labs/assets/img/l2l_1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/l2l_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Parallel lines 1" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/l2l_2-480.webp 480w,/cmput428labs/assets/img/l2l_2-800.webp 800w,/cmput428labs/assets/img/l2l_2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/l2l_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Parallel lines 2" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Parallel lines constraint for robot visual servoing. </div> <p>The equation for the line to line constraint is:</p> <p>\begin{equation} e_{par} = (l_1 \times l_2) \times (l_3 \times l_4) \end{equation}</p> <ul> <li>Apply the same process in 3a) to make the parallel lines constraint. A <strong>live implementation</strong> is mandatory.</li> <li>The recorded video for this question should include rotations that change the sign of the parallel lines constraint.</li> <li>This time our constraint is vector valued. Overlay the constraint and the points/lines we are tracking onto the video and verify that its magnitude decreases when the books are near parallel, and its sign changes when the books cross the point of being parallel.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Save the video with overlaid features to include with your submission.</li> <li>Display one frame of your video in your report.</li> </ul> <p><strong>Report Question 3b:</strong> How can we use these constraints to control a robot?</p> <hr> <h2 id="4-homography-estimation-40">4. Homography Estimation (40)</h2> <div class="row justify-content-sm-center"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/key1-480.webp 480w,/cmput428labs/assets/img/key1-800.webp 800w,/cmput428labs/assets/img/key1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/key1.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="keyboard view 1" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/key2-480.webp 480w,/cmput428labs/assets/img/key2-800.webp 800w,/cmput428labs/assets/img/key2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/key2.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="keyboard view 2" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/cmput428labs/assets/img/key3-480.webp 480w,/cmput428labs/assets/img/key3-800.webp 800w,/cmput428labs/assets/img/key3-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/cmput428labs/assets/img/key3.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="keyboard view 3" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Sample images for question 3. </div> <ul> <li>See page 39-49 of <a href="https://ugweb.cs.ualberta.ca/~vis/courses/CompVis/lectures18/lec06ProjG2D.pdf" rel="external nofollow noopener" target="_blank">these slides</a> </li> <li>See <a href="/cmput428labs/assets/img/homog1.jpg" target="_blank">sample results</a> </li> </ul> <h3 id="a-basic-dlt-function">a) Basic DLT Function</h3> <ul> <li>Write a function <code class="language-plaintext highlighter-rouge">get_homography(x_1, x_2, normalization=False)</code> that returns the homography matrix, <code class="language-plaintext highlighter-rouge">H</code>, between two images, given the 4 (or more) point correspondences, <code class="language-plaintext highlighter-rouge">x_1</code> and <code class="language-plaintext highlighter-rouge">x_2</code> between two images.</li> <li>Apply your transformation to the first image to verify your results.</li> <li>Get the point correspondences through clicking on the same four features in two different images.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Display the two original images and the transformed image in your report.</li> </ul> <p><strong>Report Question 4a:</strong> What could be one real life use of this process?</p> <h3 id="b-normalization">b) Normalization</h3> <ul> <li>Implement a normalization procedure into your algorithm. Translate the points such that their mean is centred at the origin. Scale the points such that the average norm of the distance to the origin is \(\sqrt 2\).</li> <li>Explore performance of your algorithm with your own pictures.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Using your own images, display the two originals and the transformed image in your report.</li> </ul> <p><strong>Report Question 4b:</strong> After the homography is applied, do the overlapping areas in the two images look exactly the same? Why or why not?</p> <p><strong>Report Question 4c:</strong> Correspondences are not always perfect. What happens if some of the correspondences are incorrect? How can this be handled?</p> <hr> <h2 id="5-bonus-15---augmented-reality">5. Bonus (15) - Augmented Reality</h2> <div class="row justify-content-md-center"> <div class="col-sm-8 mt-6 mt-md-6"> <figure> <video src="/cmput428labs/assets/img/textbook_ar.webm" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Textbook Augmented Reality" autoplay="" loop=""></video> </figure> </div> </div> <div class="caption"> Projecting Hartley and Zisserman onto pieces of paper. </div> <ul> <li>Track planar regions: Identify and track one or more four-point planar regions (e.g., a poster or book cover) in a video.</li> <li>Compute homography: Calculate the homography for each region.</li> <li>Project image: Warp an image (or images) onto the tracked surface so that, even as the camera moves, the projection remains fixed to the surface.</li> <li>Be creative! You can project onto trackable surface. An additional 5 bonus marks will be awarded cool-factor, as judged by the TAs.</li> </ul> <p><strong>Deliverables:</strong></p> <ul> <li>Save the video with overlaid projections to include with your submission.</li> </ul> <hr> <h2 id="submission-details">Submission Details</h2> <ul> <li>Include accompanying code used to complete each question. Ensure they are adequately commented.</li> <li>Ensure all functions are and sections are clearly labeled in your report to match the tasks and deliverables outlined in the lab.</li> <li>Organize files as follows: <ul> <li> <code class="language-plaintext highlighter-rouge">code/</code> folder containing all scripts used in the assignment.</li> <li> <code class="language-plaintext highlighter-rouge">media/</code> folder for images, videos, and results.</li> </ul> </li> <li>Final submission format: a single zip file named <code class="language-plaintext highlighter-rouge">CompVisW25_lab2.1_lastname_firstname.zip</code> containing the above structure.</li> <li>Your combined report for Lab 2.1 and 2.2 is to be submitted at the end of the topic at a later date. The report contains all media, results, and answers as specified in the instructions above. Ensure your answers are concise and directly address the questions.</li> <li>Total marks for this lab is <strong>100</strong> for all students. Your lab assignment grade with bonus marks is capped at <strong>130%</strong>.</li> </ul> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Computer Vision and Robotics Research Group. Created by Allie Luo and Justin Valentine. Adapted from <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/cmput428labs/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/cmput428labs/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/cmput428labs/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/cmput428labs/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/cmput428labs/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/cmput428labs/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/cmput428labs/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/cmput428labs/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/cmput428labs/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/cmput428labs/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>